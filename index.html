<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorare NBA Strategy Manager</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="app">
        <!-- Initial Connection Screen -->
        <div class="connection-screen" id="connectionScreen">
            <div class="connection-content">
                <div class="connection-logo">
                    <i class="fas fa-basketball-ball fa-spin"></i>
                </div>
                <h2>Connessione a Sorare NBA</h2>
                <div class="connection-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="connectionProgress"></div>
                    </div>
                    <p class="connection-status" id="connectionStatus">Inizializzazione...</p>
                </div>
            </div>
        </div>

        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header__content">
                    <div class="logo">
                        <i class="fas fa-basketball-ball"></i>
                        <h1>Sorare NBA Strategy Manager</h1>
                    </div>
                    <div class="header__info">
                        <div class="connection-indicator" id="connectionIndicator">
                            <i class="fas fa-circle"></i>
                            <span>Connesso</span>
                        </div>
                        <span class="gameweek">Gameweek 18 • 25-28 Agosto 2025</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav">
            <div class="container">
                <div class="nav__tabs">
                    <button class="nav__tab nav__tab--active" data-section="dashboard">
                        <i class="fas fa-home"></i>
                        Dashboard
                    </button>
                    <button class="nav__tab" data-section="api-status">
                        <i class="fas fa-server"></i>
                        Stato API
                    </button>
                    <button class="nav__tab" data-section="cards">
                        <i class="fas fa-id-card"></i>
                        Le Mie Carte
                    </button>
                    <button class="nav__tab" data-section="projections">
                        <i class="fas fa-chart-line"></i>
                        Proiezioni
                    </button>
                    <button class="nav__tab" data-section="optimizer">
                        <i class="fas fa-cogs"></i>
                        Ottimizzatore
                    </button>
                    <button class="nav__tab" data-section="competitions">
                        <i class="fas fa-trophy"></i>
                        Competizioni
                    </button>
                    <button class="nav__tab" data-section="settings">
                        <i class="fas fa-cog"></i>
                        Impostazioni
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main">
            <div class="container">
                
                <!-- Dashboard Section -->
                <section id="dashboard" class="section section--active">
                    <div class="dashboard">
                        <div class="dashboard-header">
                            <h2>Dashboard Overview</h2>
                            <div class="quick-sync">
                                <button class="btn btn--primary" id="refreshDataBtn">
                                    <i class="fas fa-sync-alt"></i>
                                    Aggiorna Dati
                                </button>
                                <span class="last-sync" id="lastSyncTime">Ultimo sync: 16:17</span>
                            </div>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-card__icon">
                                    <i class="fas fa-id-card"></i>
                                </div>
                                <div class="stat-card__content">
                                    <h3 id="totalCardsCount">10</h3>
                                    <p>Carte Limited</p>
                                    <div class="sync-status" data-status="synced">
                                        <i class="fas fa-check-circle"></i>
                                        <span>Sincronizzato</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-card__icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-card__content">
                                    <h3 id="avgPowerScore">106.8%</h3>
                                    <p>Power Score Medio</p>
                                    <div class="sync-status" data-status="synced">
                                        <i class="fas fa-check-circle"></i>
                                        <span>Aggiornato</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-card__icon">
                                    <i class="fas fa-gamepad"></i>
                                </div>
                                <div class="stat-card__content">
                                    <h3 id="gamesThisWeek">47</h3>
                                    <p>Partite questa settimana</p>
                                    <div class="sync-status" data-status="syncing">
                                        <i class="fas fa-sync-alt fa-spin"></i>
                                        <span>Aggiornamento...</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-card__icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="stat-card__content">
                                    <h3 id="activeCompetitions">3</h3>
                                    <p>Competizioni attive</p>
                                    <div class="sync-status" data-status="synced">
                                        <i class="fas fa-check-circle"></i>
                                        <span>Sincronizzato</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Live Feed -->
                        <div class="live-feed">
                            <h3>
                                <i class="fas fa-rss"></i>
                                Feed Live
                            </h3>
                            <div class="feed-container" id="liveFeed">
                                <!-- Live feed items will be added here -->
                            </div>
                        </div>

                        <div class="quick-actions">
                            <h3>Azioni Rapide</h3>
                            <div class="action-buttons">
                                <button class="btn btn--primary" data-action="optimize">
                                    <i class="fas fa-magic"></i>
                                    Ottimizza Formazioni
                                </button>
                                <button class="btn btn--secondary" data-action="projections">
                                    <i class="fas fa-chart-line"></i>
                                    Vedi Proiezioni
                                </button>
                                <button class="btn btn--outline" id="testConnectionBtn">
                                    <i class="fas fa-plug"></i>
                                    Test Connessione
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- API Status Section -->
                <section id="api-status" class="section">
                    <div class="api-status-section">
                        <div class="section-header">
                            <h2>Stato API e Connessioni</h2>
                            <button class="btn btn--primary" id="refreshConnectionBtn">
                                <i class="fas fa-sync-alt"></i>
                                Refresh Connessioni
                            </button>
                        </div>

                        <div class="api-cards-grid">
                            <div class="api-card" data-api="sorare">
                                <div class="api-card__header">
                                    <div class="api-card__icon">
                                        <i class="fas fa-basketball-ball"></i>
                                    </div>
                                    <div class="api-card__info">
                                        <h3>Sorare API</h3>
                                        <p>api.sorare.com</p>
                                    </div>
                                    <div class="status-indicator status--online">
                                        <i class="fas fa-circle"></i>
                                        <span>Online</span>
                                    </div>
                                </div>
                                <div class="api-card__stats">
                                    <div class="stat-row">
                                        <span>Ultimo Aggiornamento:</span>
                                        <span class="last-update">16:17:23</span>
                                    </div>
                                    <div class="stat-row">
                                        <span>Tempo di Risposta:</span>
                                        <span class="response-time">142ms</span>
                                    </div>
                                    <div class="stat-row">
                                        <span>Uptime:</span>
                                        <span class="uptime">99.7%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="api-card" data-api="rotowire">
                                <div class="api-card__header">
                                    <div class="api-card__icon">
                                        <i class="fas fa-chart-bar"></i>
                                    </div>
                                    <div class="api-card__info">
                                        <h3>RotoWire API</h3>
                                        <p>api.rotowire.com</p>
                                    </div>
                                    <div class="status-indicator status--online">
                                        <i class="fas fa-circle"></i>
                                        <span>Online</span>
                                    </div>
                                </div>
                                <div class="api-card__stats">
                                    <div class="stat-row">
                                        <span>Ultimo Aggiornamento:</span>
                                        <span class="last-update">16:15:41</span>
                                    </div>
                                    <div class="stat-row">
                                        <span>Tempo di Risposta:</span>
                                        <span class="response-time">89ms</span>
                                    </div>
                                    <div class="stat-row">
                                        <span>Uptime:</span>
                                        <span class="uptime">98.9%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="api-card" data-api="nba">
                                <div class="api-card__header">
                                    <div class="api-card__icon">
                                        <i class="fas fa-database"></i>
                                    </div>
                                    <div class="api-card__info">
                                        <h3>NBA Data API</h3>
                                        <p>stats.nba.com</p>
                                    </div>
                                    <div class="status-indicator status--warning">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <span>Lento</span>
                                    </div>
                                </div>
                                <div class="api-card__stats">
                                    <div class="stat-row">
                                        <span>Ultimo Aggiornamento:</span>
                                        <span class="last-update">16:16:12</span>
                                    </div>
                                    <div class="stat-row">
                                        <span>Tempo di Risposta:</span>
                                        <span class="response-time">234ms</span>
                                    </div>
                                    <div class="stat-row">
                                        <span>Uptime:</span>
                                        <span class="uptime">99.2%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Usage Statistics -->
                        <div class="usage-stats">
                            <h3>Statistiche Utilizzo API</h3>
                            <div class="usage-cards">
                                <div class="usage-card">
                                    <h4>Chiamate API Oggi</h4>
                                    <div class="usage-value">1,247 / 5,000</div>
                                    <div class="usage-bar">
                                        <div class="usage-fill" style="width: 25%;"></div>
                                    </div>
                                </div>
                                <div class="usage-card">
                                    <h4>Bandwidth Utilizzata</h4>
                                    <div class="usage-value">847 MB / 2 GB</div>
                                    <div class="usage-bar">
                                        <div class="usage-fill" style="width: 42%;"></div>
                                    </div>
                                </div>
                                <div class="usage-card">
                                    <h4>Cache Hit Rate</h4>
                                    <div class="usage-value">89.3%</div>
                                    <div class="usage-bar">
                                        <div class="usage-fill" style="width: 89%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Cards Section -->
                <section id="cards" class="section">
                    <div class="cards-section">
                        <div class="section-header">
                            <h2>
                                Le Mie Carte Limited
                                <span class="sync-indicator" id="cardsSyncIndicator">
                                    <i class="fas fa-check-circle"></i>
                                    Sincronizzato
                                </span>
                            </h2>
                            <div class="filters">
                                <select class="form-control filter-select" id="teamFilter">
                                    <option value="">Tutte le squadre</option>
                                </select>
                                <select class="form-control filter-select" id="positionFilter">
                                    <option value="">Tutte le posizioni</option>
                                    <option value="PG">Point Guard</option>
                                    <option value="SG">Shooting Guard</option>
                                    <option value="SF">Small Forward</option>
                                    <option value="PF">Power Forward</option>
                                    <option value="C">Center</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Loading Skeleton -->
                        <div class="loading-skeleton hidden" id="cardsLoadingSkeleton">
                            <div class="skeleton-cards">
                                <div class="skeleton-card"></div>
                                <div class="skeleton-card"></div>
                                <div class="skeleton-card"></div>
                                <div class="skeleton-card"></div>
                            </div>
                        </div>
                        
                        <div class="cards-grid" id="cardsGrid">
                            <!-- Cards will be populated by JavaScript -->
                        </div>
                    </div>
                </section>

                <!-- Other sections remain the same but with sync indicators added -->
                <section id="projections" class="section">
                    <div class="projections-section">
                        <div class="section-header">
                            <h2>
                                Proiezioni Settimanali
                                <span class="sync-indicator" id="projectionsSyncIndicator">
                                    <i class="fas fa-sync-alt fa-spin"></i>
                                    Aggiornamento in corso...
                                </span>
                            </h2>
                            <button class="btn btn--secondary" id="refreshProjectionsBtn">
                                <i class="fas fa-refresh"></i>
                                Aggiorna Proiezioni
                            </button>
                        </div>
                        
                        <div class="projections-table-container">
                            <table class="projections-table">
                                <thead>
                                    <tr>
                                        <th>Giocatore</th>
                                        <th>Squadra</th>
                                        <th>Partite</th>
                                        <th>Proiezione Punti</th>
                                        <th>Difficoltà</th>
                                        <th>Consiglio</th>
                                        <th>Confidenza</th>
                                    </tr>
                                </thead>
                                <tbody id="projectionsTableBody">
                                    <!-- Projections will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <section id="optimizer" class="section">
                    <div class="optimizer-section">
                        <h2>Ottimizzatore Formazioni</h2>
                        
                        <div class="optimizer-grid">
                            <div class="optimizer-controls">
                                <div class="form-group">
                                    <label class="form-label">Competizione</label>
                                    <select class="form-control" id="competitionSelect">
                                        <option value="">Seleziona competizione</option>
                                    </select>
                                </div>
                                
                                <div class="points-info" id="pointsInfo">
                                    <div class="points-cap">
                                        <span>Points Cap: <strong id="pointsCapValue">--</strong></span>
                                    </div>
                                    <div class="points-used">
                                        <span>Points Usati: <strong id="pointsUsedValue">0</strong></span>
                                    </div>
                                    <div class="points-remaining">
                                        <span>Rimanenti: <strong id="pointsRemainingValue">--</strong></span>
                                    </div>
                                </div>
                                
                                <button class="btn btn--primary btn--full-width" id="autoOptimizeBtn">
                                    <i class="fas fa-magic"></i>
                                    Ottimizza Automaticamente
                                </button>
                            </div>
                            
                            <div class="lineup-builder">
                                <h3>Formazione Corrente</h3>
                                <div class="lineup-slots" id="lineupSlots">
                                    <div class="lineup-slot" data-position="0">
                                        <div class="slot-label">Giocatore 1</div>
                                        <div class="slot-content">Trascina qui una carta</div>
                                    </div>
                                    <div class="lineup-slot" data-position="1">
                                        <div class="slot-label">Giocatore 2</div>
                                        <div class="slot-content">Trascina qui una carta</div>
                                    </div>
                                    <div class="lineup-slot" data-position="2">
                                        <div class="slot-label">Giocatore 3</div>
                                        <div class="slot-content">Trascina qui una carta</div>
                                    </div>
                                    <div class="lineup-slot" data-position="3">
                                        <div class="slot-label">Giocatore 4</div>
                                        <div class="slot-content">Trascina qui una carta</div>
                                    </div>
                                    <div class="lineup-slot" data-position="4">
                                        <div class="slot-label">Giocatore 5</div>
                                        <div class="slot-content">Trascina qui una carta</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="available-cards">
                            <h3>Carte Disponibili</h3>
                            <div class="available-cards-grid" id="availableCards">
                                <!-- Available cards will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </section>

                <section id="competitions" class="section">
                    <div class="competitions-section">
                        <h2>Competizioni Attive</h2>
                        <div class="competitions-grid" id="competitionsGrid">
                            <!-- Competitions will be populated by JavaScript -->
                        </div>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settings" class="section">
                    <div class="settings-section">
                        <h2>Impostazioni API</h2>
                        
                        <div class="settings-grid">
                            <div class="settings-card">
                                <h3>Configurazione API Key</h3>
                                <div class="api-key-form">
                                    <div class="form-group">
                                        <label class="form-label">API Key Sorare</label>
                                        <div class="api-key-input-group">
                                            <input type="password" class="form-control" id="apiKeyInput" value="eceefb830b379e802bbd1c2c1cdeba6069764fd598efdd9d62b5a9240f2e6210e6c4991a338a38e093b34a0396495508c77bffb12dbd5f7b8db3e65c156sr128">
                                            <button class="btn btn--outline" id="toggleApiKeyBtn">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                        <small>La tua API key è crittografata e sicura</small>
                                    </div>
                                    <div class="api-key-status">
                                        <div class="status-item">
                                            <i class="fas fa-check-circle" style="color: var(--color-success);"></i>
                                            <span>API Key Valida</span>
                                        </div>
                                        <div class="status-item">
                                            <i class="fas fa-shield-alt" style="color: var(--color-success);"></i>
                                            <span>Connessione Sicura</span>
                                        </div>
                                    </div>
                                    <button class="btn btn--primary" id="testApiKeyBtn">
                                        <i class="fas fa-plug"></i>
                                        Test Connessione API
                                    </button>
                                </div>
                            </div>

                            <div class="settings-card">
                                <h3>Cache Management</h3>
                                <div class="cache-info">
                                    <div class="cache-stat">
                                        <span>Cache Size:</span>
                                        <strong>47.3 MB</strong>
                                    </div>
                                    <div class="cache-stat">
                                        <span>Last Clear:</span>
                                        <strong>2 giorni fa</strong>
                                    </div>
                                    <div class="cache-stat">
                                        <span>Hit Rate:</span>
                                        <strong>89.3%</strong>
                                    </div>
                                </div>
                                <button class="btn btn--outline btn--full-width" id="clearCacheBtn">
                                    <i class="fas fa-trash"></i>
                                    Cancella Cache
                                </button>
                            </div>

                            <div class="settings-card">
                                <h3>Auto-Refresh Settings</h3>
                                <div class="auto-refresh-settings">
                                    <div class="form-group">
                                        <label class="form-label">Frequenza Aggiornamento</label>
                                        <select class="form-control" id="refreshIntervalSelect">
                                            <option value="5">5 minuti</option>
                                            <option value="15" selected>15 minuti</option>
                                            <option value="30">30 minuti</option>
                                            <option value="60">1 ora</option>
                                            <option value="0">Manuale</option>
                                        </select>
                                    </div>
                                    <div class="setting-toggle">
                                        <label class="toggle-label">
                                            <input type="checkbox" id="autoRefreshToggle" checked>
                                            <span class="toggle-slider"></span>
                                            Auto-refresh attivo
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Loading Overlay -->
        <div class="loading-overlay hidden" id="loadingOverlay">
            <div class="loading-spinner">
                <i class="fas fa-basketball-ball fa-spin"></i>
                <p id="loadingText">Connessione a Sorare NBA...</p>
            </div>
        </div>

        <!-- Progress Modal -->
        <div class="modal hidden" id="progressModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="progressModalTitle">Aggiornamento Dati</h3>
                </div>
                <div class="modal-body">
                    <div class="progress-step" id="step1">
                        <div class="step-icon">
                            <i class="fas fa-sync-alt fa-spin"></i>
                        </div>
                        <div class="step-content">
                            <h4>Scaricamento carte Limited...</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" id="cardsProgress"></div>
                            </div>
                            <span class="progress-text" id="cardsProgressText">0/10 carte</span>
                        </div>
                    </div>
                    <div class="progress-step" id="step2">
                        <div class="step-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="step-content">
                            <h4>Aggiornamento proiezioni...</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" id="projectionsProgress"></div>
                            </div>
                            <span class="progress-text" id="projectionsProgressText">In attesa...</span>
                        </div>
                    </div>
                    <div class="progress-step" id="step3">
                        <div class="step-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="step-content">
                            <h4>Sincronizzazione competizioni...</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" id="competitionsProgress"></div>
                            </div>
                            <span class="progress-text" id="competitionsProgressText">In attesa...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div class="toast-container" id="toastContainer">
            <!-- Toast notifications will be added here -->
        </div>

        <!-- Error Modal -->
        <div class="modal hidden" id="errorModal">
            <div class="modal-content">
                <div class="modal-header error-header">
                    <h3><i class="fas fa-exclamation-triangle"></i> Errore di Connessione</h3>
                </div>
                <div class="modal-body">
                    <p id="errorMessage">Si è verificato un errore durante la connessione alle API.</p>
                    <div class="error-details">
                        <strong>Codice errore:</strong> <span id="errorCode">API_TIMEOUT</span><br>
                        <strong>Suggerimento:</strong> <span id="errorSuggestion">Verifica la connessione internet e riprova.</span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn--outline" id="closeErrorBtn">Chiudi</button>
                    <button class="btn btn--primary" id="retryConnectionBtn">
                        <i class="fas fa-redo"></i>
                        Riprova
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>